# datagrip-extractors

A set of extractors `groovy` files to export query results from JetBrain DataGrip query tool into different formats (because the built-in extractors kind of suck).

## Install

Once located the `extractor` folder of datagrip:

```bash
# set project home
export DEH=$HOME/dev/prj/datagrip-extractors/
# set datagrip extractor folder
export DET="<datagrip extractor folder>"

# symlink extractors to datagrip 
for f in "$DEH"/src/*.groovy; do  ln -s "$f" "$DET/$(basename $f)"; done;
```

# SQL-Insert-Multirow

Evolution of the built-in `SQL-Inserts` from JetBrains. 

It copies result set and generates 1 single SQL `insert` statement with multiple rows:

```sql
INSERT INTO <schema>.<table> (<col1>, <col2>, ..., <colx>)
VALUES (<row1-val1>, <row1-val2>, ..., <row1-valx>),
       (<row2-val1>, <row2-val2>, ..., <row2-valx>),
       ...,
       (<rowy-val1>, <rowy-val2>, ..., <rowy-valx>);
```

It can be very useful to reduce execution time, compared to multiple `INSERT` statements, with a long list of rows or slow connections .

# SQL-Select-From-Value-List

Copies the result set generating a `SELECT` statement that reads from the fixed value list generated by the selected values in the result table.

```sql
SELECT * FROM ( 
  VALUES (<row1-val1>, <row1-val2>, ..., <row1-valx>),
         (<row2-val1>, <row2-val2>, ..., <row2-valx>),
         ...,
         (<rowy-val1>, <rowy-val2>, ..., <rowy-valx>)
  ) AS v (<col1>, <col2>, ..., <colx>)
```

Useful when you have to cross check data from different databases, without creating a connection between the two, you can use this extractor to generate a table on-the-fly to be used in queries on the other database.

# SQL-Where-Conditions

It copies the selected columns/rows in a *where condition* fashion. It lists all the selected columns (all together in `AND`) and uses the row(s) selected to be compared as `=` in case of single selection (= 1 row) or with keyword `IN` in case of multiple selection.

The result is something like:

```sql
-- single selections
<col1> = <row1-val1>
AND <col2> = <row1-val2>
...
AND <colx> = <row1-valx>

-- multiple selections
<col1> IN (<row1-val1>, <row2-val1>, ..., <rowy-val1>)
AND <col2> IN (<row1-val2>, <row2-val2>, ..., <rowy-val2>)
...
AND <colx> IN (<row1-valx>, <row2-valx>, ..., <rowy-valx>)

```

Useful to narrow down subsequent searches using long annoying list of criteria or criteria values.

# XLS-friendly

Apparently JetBrians failed so far to create an extractor that works fine to copy data into excel, matching European locales for numbers. 

I've done it.
